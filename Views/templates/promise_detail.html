{% extends "layout.html" %}
{% block content %}
<div class="card shadow-sm mt-4">
    <div class="card-body">
        <h3>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ñ‡∏≥‡∏™‡∏±‡∏ç‡∏ç‡∏≤</h3>
        <p class="lead">{{ promise.description }}</p>
        <hr>
        <p><strong>‡∏ú‡∏π‡πâ‡πÉ‡∏´‡πâ‡∏™‡∏±‡∏ç‡∏ç‡∏≤:</strong> <a href="{{ url_for('politician_controller.politician_profile', pol_id=promise.politician_id) }}">{{ promise.politician.name }}</a></p>
        <p>
            <strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô:</strong>
            {% if promise.status == '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°' %}
                <span class="badge bg-secondary">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</span> 
            {% elif promise.status == '‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡∏´‡∏≤‡∏¢' %}
                <span class="badge bg-danger">‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡∏´‡∏≤‡∏¢</span> 
            {% elif promise.status == '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£' %}
                <span class="badge bg-warning text-dark">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</span> 
            {% else %}
                <span class="badge bg-info">{{ promise.status }}</span>
            {% endif %}
        </p>

        <h5 class="mt-4">üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</h5>
        <ul class="list-group mb-4">
            {% for update in promise.updates|sort(attribute='update_date', reverse=True) %}
            <li class="list-group-item">
                <small class="text-muted">{{ update.update_date.strftime('%d/%m/%Y %H:%M') }}</small>
                <p class="mb-0">{{ update.detail }}</p>
            </li>
            {% else %}
            <li class="list-group-item text-muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤</li>
            {% endfor %}
        </ul>

        {# ‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ADMIN #}
        {% if session.get('role') == 'ADMIN' %}
            {% if promise.status != '‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡∏´‡∏≤‡∏¢' %}
                {# ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ '‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡∏´‡∏≤‡∏¢' ‡πÉ‡∏´‡πâ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Update ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÑ‡∏î‡πâ #}
                <a href="{{ url_for('promise_controller.update_promise', promise_id=promise.id) }}" class="btn btn-warning">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∑‡∏ö‡∏´‡∏ô‡πâ‡∏≤ / ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</a>
            {% else %}
                <div class="alert alert-dark d-inline-block p-2">
                    <button class="btn btn-secondary" disabled>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÑ‡∏î‡πâ (‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏á‡∏µ‡∏¢‡∏ö‡∏´‡∏≤‡∏¢)</button>
                </div>
            {% endif %}
        {% endif %}
        
        <div class="mt-3">
            <a href="{{ url_for('promise_controller.all_promises') }}" class="btn btn-outline-primary">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏£‡∏ß‡∏°</a>
        </div>
    </div>
</div>
{% endblock %}